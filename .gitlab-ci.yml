
# heroku:
#   stage: deploy
#   script:
#     - git push -f https://heroku:$HEROKU_API_KEY@git.heroku.com/weather-daddy.git master


deliver_today:
  image: "ruby:2.5"
  # only:
    # - schedules
  cache:
    paths:
      - vendor
  before_script:
    # - apt-get update -qq && apt-get install -y telnet curl
    - ruby -v
    - bundle install -j $(nproc) --path vendor/gems
    - ls -lah vendor
    - ls -lah vendor/gems
  script:
    # - telnet smtp.qq.com 587
    - bundle exec rake deliver_today



deliver_tomorrow:
  only:
    - schedules
  cache:
    paths:
      - vendor
  before_script:
    - ruby -v
    - bundle install -j $(nproc) --path vendor/gems
    - ls -lah vendor
    - ls -lah vendor/gems
  script:
    - bundle exec rake deliver_tomorrow



deliver_others:
  only:
    - schedules
  cache:
    paths:
      - vendor
  before_script:
    - ruby -v
    - bundle install -j $(nproc) --path vendor/gems
    - ls -lah vendor
    - ls -lah vendor/gems
  script:
    - bundle exec rake deliver_others
